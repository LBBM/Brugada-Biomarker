library(readr)
library(pheatmap)
library(ggplot2)
library(hrbrthemes)
library(corrplot)

getwd()

dnam <- read.csv("brs_dataset.txt", sep = "\t")
head(dnam)
row.names(dnam)<- dnam[,1]
dnam<- dnam[,-1]
head(dnam)
dim(dnam)
#dnam$Class <- factor(dnam$Class, levels=c("Control", "Non-BrS", "Possible", "BrS"))
summary(dnam)
mm<- data.matrix(dnam[,c(3:5)])
dim(mm)

cat_df = data.frame("Classification"=dnam$classif)
head(cat_df)
rownames(cat_df) = row.names(dnam)

pheatmap(log(t(mm)), cutree_cols = 3, cluster_rows = T, cluster_cols = F, annotation_col = cat_df, show_colnames =F,
         cellwidth = 15, cellheight = 18, fontsize = 8, 
         main= "Cluster autoantibodys ELISA O.D. by Shanghay Classification", filename = "test.jpeg")
